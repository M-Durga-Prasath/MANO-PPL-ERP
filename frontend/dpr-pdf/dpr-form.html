<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="dpr-form.css">
</head>
<body>
    <div class="main-content">
        <div class="header">
          <img src="./images/Mano-Logo-.png">
        </div>
        <div class="below-header">
            <div class="inside-below-header">
                <h1>DAILY PROGRESS REPORT</h1>
                <p>REPORT DATE</p>
            </div>
        </div>
        <div class="except-header">
            <div class="project-forms">
                <div class="table-header">
                    <h2>PROJECT DETAILS</h2>
                </div>
                <table>
                        <tbody>
                          <tr>
                            <td>Name of Work:</td>
                            <td style="width: fit-content;text-align: right;">Sati Darshan, Malad</td>
                          </tr>
                          <tr>
                            <td>Project Start Date:</td>
                            <td style="width: fit-content;text-align: right;" id="startdate">02-05-2022</td>
                          </tr>
                          <tr>
                            <td>Employer:</td>
                            <td style="width: fit-content;text-align: right;">M/s Goyal Sati Darshan LLP</td>
                          </tr>
                          <tr>
                            <td>Project Completion Date:</td>
                            <td style="width: fit-content;text-align: right;" id="enddate">16-05-2025</td>
                          </tr>
                          <tr>
                            <td>Contract No.:</td>
                            <td style="width: fit-content;text-align: right;">2223-57</td>
                          </tr>
                          <tr>
                            <td>Location:</td>
                            <td style="width: fit-content;text-align: right;" >Malad(W), Mumbai</td>
                          </tr>
                          <tr>
                            <td>Duration in Days:</td>
                            <td style="width: fit-content;text-align: right;" id="TotalDays"></td>
                          </tr>
                          <tr>
                            <td id="elapsedDays"></td>
                            <td style="width: fit-content;text-align: right;" id="remainingDays"></td>
                          </tr>
                        </tbody>
                </table>
            </div>
            <div class="project-forms">
                <div class="table-header">
                    <h2>SITE CONDITION</h2>
                </div>
                <table>
                    <thead>
                      <tr>
                        <th>Condition</th>
                        <th>Time</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td>
                          <div class="rainy-button">
                          <input id="rainy" type="radio" name="weather" value="Rainy">
                            <label for="rainy" class="radio-label">
                              <img src="./images/rainy.png" alt="Rainy">
                            </label>
                            <p>rainy</p> 
                          </div>
                          <div class="sunny-button">    
                            <input id="sunny" type="radio" name="weather" value="Sunny">
                            <label for="sunny" class="radio-label">
                              <img src="./images/sunny.webp" alt="Sunny">
                            </label>
                            <p>sunny</p>
                          </div>
                        </td>
                        <td colspan="4">
                          From Time:- &nbsp; &nbsp; &nbsp; <input id="from-time" type="time" />
                        </td>
                      </tr>
                      <tr>
                        <td>
                          <div class="slushy-button">
                          <input id="slushy" type="radio" name="ground-state" value="slushy">
                          <label for="slushy" class="radio-label">
                            <img src="./images/slushy.png" alt="Option 1">
                          </label>
                          <p>Slushy</p>
                        </div>
                        <div class="slushy-button">
                          <input id="dry" type="radio" name="ground-state" value="dry">
                          <label for="dry" class="radio-label">
                            <img src="./images/dry.png" alt="Option 1">
                          </label>
                          <p>DRY</p>
                        </div>
                        </td>
                        <td>To Time:- &nbsp; &nbsp; &nbsp;<input id="to-time" type="time" /></td>
                      </tr>
                    </tbody>
                  </table>
            </div>
            <div class="project-forms scrollable after-600">
                <div class="table-header fixed-header">
                    <h2>LABOUR REPORT</h2>
                </div>
                <div class="action-buttons">
                    <button onclick="addRow()">Add Row</button>
                    <button onclick="deleteRow()">Delete Row</button>
                    <button onclick="resetLabourReport()">Reset</button>
                  </div>
                  <table id="labourTable">
                    <thead>
                      <tr>
                        <th>Agency Name</th>
                        <th>Mason</th>
                        <th>Carp</th>
                        <th>Fitter</th>
                        <th>Electrical</th>
                        <th>Painter</th>
                        <th>Gypsum</th>
                        <th>Plumber</th>
                        <th>Helper</th>
                        <th>Staff</th>
                        <th>Total</th>
                        <th>Remarks</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr class="data-row">
                        <td><input type="text" value="MAPLANI/GOYAL" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="cell-input" /></td>
                        <td><input type="number" class="row-total" disabled /></td>
                        <td><input type="text" /></td>
                      </tr>
                      <tr>
                        <td>TOTAL</td>
                        <td><input id="1_total" type="number" disabled /></td>
                        <td><input id="2_total" type="number" disabled /></td>
                        <td><input id="3_total" type="number" disabled /></td>
                        <td><input id="4_total" type="number" disabled /></td>
                        <td><input id="5_total" type="number" disabled /></td>
                        <td><input id="6_total" type="number" disabled /></td>
                        <td><input id="7_total" type="number" disabled /></td>
                        <td><input id="8_total" type="number" disabled /></td>
                        <td><input id="9_total" type="number" disabled /></td>
                        <td><input id="grandtotal" type="number" disabled /></td>
                        <td><input id="remarks_total" type="text" /></td>
                      </tr>
                    </tbody>
                  </table>
            </div>
            <div class="project-forms scrollable " style="height: auto;">
                <div class="today-tomorrow-planning after-600">
                    <div class="today-planning">
                        <div class="table-header fixed-header">
                            <h2>TODAY'S PROGRESS</h2>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>
                                        Task
                                    </th>
                                    <th>
                                        Quantity
                                    </th>
                                </tr>
                            </thead>
                            <tr>
                                <td>
                                    <input id="today-progress" type="text">
                                </td>
                                <td>
                                    <input id="today-progress-quantity" type="number">
                                </td>
                            </tr>
                        </table>
                    </div>
                    <div class="tomorrow-planning">
                        <div class="table-header fixed-header-smol">
                            <h2>TOMORROW'S PLANNING</h2>
                        </div>
                        <table>
                            <thead>
                                <tr>
                                    <th>
                                        Task
                                    </th>
                                    <th>
                                        Quantity
                                    </th>
                                </tr>
                            </thead>
                            <tr>
                                <td>
                                    <input id="tomorrows-planning" type="text">
                                </td>
                                <td>
                                    <input id="tomorrows-planning-quantity" type="number">
                                </td>
                            </tr>
                        </table>
                    </div>
                    </div>
                </div>
            </div>
      <div class="submit-section">
        <button onclick="displaydata()">GENERATE DPR</button>
      </div>
        </div>
</body>
<script>
//=============EVERYTHING RELATED TO FORM INPUT============================//

function displaydata(){
  const input_array = []
  const today_progress = document.getElementById("today-progress").value;
  const today_progress_quantity = document.getElementById("today-progress-quantity").value;
  const tomorrows_planning = document.getElementById("tomorrows-planning").value;
  const tomorrows_planning_quantity = document.getElementById("tomorrows-planning-quantity").value;
  const from_time = document.getElementById("from-time").value;
  const to_time = document.getElementById("to-time").value;
  let radio_buttons_value = "";
  let ground_ground_state_value = "";
  var radio_buttons = document.getElementsByName("weather");
  var ground_state_button = document.getElementsByName("ground-state");

  for (i=0;i<radio_buttons.length;i++){
    if(radio_buttons[i].checked){
      radio_buttons_value = radio_buttons[i].value;
    }
  }

  for(j=0;j<ground_state_button.length;j++){
    if(ground_state_button[j].checked){
      ground_ground_state_value = ground_state_button[j].value;
    }
  }

  input_array.push(radio_buttons_value,ground_ground_state_value,today_progress,today_progress_quantity,tomorrows_planning,
  tomorrows_planning_quantity,from_time,to_time);





  const table = document.getElementById('labourTable');
      const rows = Array.from(table.rows);  // Include the Header row

      const tableData = rows.map(row => {
        const cells = Array.from(row.cells);
        return cells.map(cell => cell.querySelector('input') ? cell.querySelector('input').value : '');
      });

      sessionStorage.setItem('userTableData', JSON.stringify(tableData));





  
  sessionStorage.setItem("form-values", JSON.stringify(input_array));
window.location.href = "dpr-pdf.html";
}





//----------------------------------------------------  EVERYTHING RELATED TO ADD AND DELETE ROW ----------------------------------------//

function addRow() {
  const tableBody = document.querySelector("#labourTable tbody");
  const newRow = document.createElement("tr");
  newRow.classList.add("data-row");
  newRow.innerHTML = `
    <td><input type="text" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="cell-input" /></td>
    <td><input type="number" class="row-total" disabled /></td>
    <td><input type="text" /></td>
  `;
  tableBody.insertBefore(newRow, tableBody.lastElementChild);

  const newInputs = newRow.querySelectorAll(".cell-input");
  newInputs.forEach((input) => {
    input.addEventListener("input", (event) => {
      validateAndCalculate(event.target);
    });
  });
}

function deleteRow() {
  const rows = document.querySelectorAll(".data-row");
  if (rows.length > 1) {
    rows[rows.length - 1].remove();
    calculateGrandTotal(); // Recalculate totals
  }
}




</script>
</html>